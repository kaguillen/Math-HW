.Random.seed
str(.Random.seed)
n = 921
s = 728
theta_hat = s/n
se_theta_hat = sqrt(theta_hat * (1-theta_hat)/n))
se_theta_hat = sqrt(theta_hat * (1-theta_hat)/n)
alpha = 0.0001
confidence_number = qnorm(1-alpha/2)
confidence_interval = c(tehta_hat - confidence_number * se_theta_hat, theta_hat + confidence_number * se_theta_hat)
confidence_interval = c(theta_hat - confidence_number * se_theta_hat, theta_hat + confidence_number * se_theta_hat)
mean(c(1,2,4))
mean(c(1, NA, 4))
mean(c(1, 345,654456,732,64567,244,7644, 4))
help(mean)
mean(c(1, NA, 4), na.rm = TRUE)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(exponential.likelihood)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
emperical.bayes.result
emperical.bayes.result$theta.hat
empirical.bayes.results$theta.hat
rjags
rjags
install.packages("rjags")
rjags
setwd("~/Documents/Math-HW/Stats-206/Rjags")
rm( list = ls( ) )
mu.grid.1 <- seq( -3000, 3000, length = 500 )
mu.grid.2 <- seq( 402.7, 405.8, length = 500 )
par( mfrow = c( 2, 1 ) )
plot( mu.grid.1, dnorm( mu.grid.1, 0, 1000 ), type = 'l',
lwd = 3, col = 'cornflowerblue', xlab = 'mu', ylab = 'Density' )
abline( v = 402.7, lwd = 3, lty = 3, col = 'darkcyan' )
abline( v = 405.8, lwd = 3, lty = 3, col = 'darkcyan')
plot( mu.grid.2, dnorm( mu.grid.2, 0, 1000 ), type = 'l',
lwd = 3, col = 'chocolate1', xlab = 'mu', ylab = 'Density',
ylim = c( 0, 4e-04 ) )
par( mfrow = c( 1, 1 ) )
mu.grid.1 <- seq( -3000, 3000, length = 500 )
mu.grid.2 <- seq( 402.7, 405.8, length = 500 )
par( mfrow = c( 2, 1 ) )
plot( mu.grid.1, dnorm( mu.grid.1, 0, 1000 ), type = 'l',
lwd = 3, col = 'cornflowerblue', xlab = 'mu', ylab = 'Density' )
abline( v = 402.7, lwd = 3, lty = 3, col = 'darkcyan' )
abline( v = 405.8, lwd = 3, lty = 3, col = 'darkcyan')
plot( mu.grid.2, dnorm( mu.grid.2, 0, 1000 ), type = 'l',
lwd = 3, col = 'chocolate1', xlab = 'mu', ylab = 'Density',
ylim = c( 0, 4e-04 ) )
par( mfrow = c( 1, 1 ) )
install.packages( 'rjags' )
library( rjags )
library(rjags)
library(rjags)
nb10.data <- list(
y = c( 409., 400., 406., 399., 402., 406., 401., 403., 401., 403.,
398., 403., 407., 402., 401., 399., 400., 401., 405., 402.,
408., 399., 399., 402., 399., 397., 407., 401., 399., 401.,
403., 400., 410., 401., 407., 423., 406., 406., 402., 405.,
405., 409., 399., 402., 407., 406., 413., 409., 404., 402.,
404., 406., 407., 405., 411., 410., 410., 410., 401., 402.,
404., 405., 392., 407., 406., 404., 403., 408., 404., 407.,
412., 406., 409., 400., 408., 404., 401., 404., 408., 406.,
408., 406., 401., 412., 393., 437., 418., 415., 404., 401.,
401., 407., 412., 375., 409., 406., 398., 406., 403., 404. ),
n = 100 )
nb10.initial.values <- list( mu = 404.59, sigma = 4.0, nu = 5.0,
y.new = 400.0 )
nb10.run.1 <- jags.model( file = 'nb10-t-model.txt', data = nb10.data,
inits = nb10.initial.values )
set.seed( 314159 )
n.burnin <- 1000
system.time(
update( nb10.run.1, n.iter = n.burnin )
)
n.monitor <- 100000
system.time(
nb10.run.1.results <- jags.samples( nb10.run.1,
variable.names = c( "mu", "sigma", "nu", "y.new" ),
n.iter = n.monitor )
)
mu.star <- nb10.run.1.results$mu
sigma.star <- nb10.run.1.results$sigma
nu.star <- nb10.run.1.results$nu
y.new.star <- nb10.run.1.results$y.new
par( mfrow = c( 2, 2 ) )
plot( 1:n.monitor, mu.star, type = 'l', xlab = 'Iteration Number',
ylab = 'mu', col = 'maroon' )
plot( density( mu.star ), xlab = 'mu',
lwd = 3, col = 'cornflowerblue', main = 'NB10 Case Study' )
mu.hat.mle <- 404.278406
abline( v = mu.hat.mle, lwd = 3, lty = 2, col = 'red' )
legend( 402.2, 0.8, legend = 'MLE', col = 'red', lty = 2, lwd = 3 )
acf( as.ts( mu.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'darkcyan', lwd = 3 )
pacf( as.ts( mu.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'chocolate1', lwd = 3 )
par( mfrow = c( 1, 1 ) )
c( mean( mu.star ), sd( mu.star ), quantile( mu.star,
probs = c( 0.0005, 0.9995 ) ) )
print( rho.1.hat.mu.star <- cor( mu.star[ 1:( n.monitor - 1 ) ],
mu.star[ 2:n.monitor ] ) )
print( rho.1.hat.mu.star <- cor( mu.star[ 1:( n.monitor - 1 ) ],
mu.star[ 2:n.monitor ] ) )
print( rho.1.hat.mu.star <- cor( mu.star[ 1:( n.monitor - 1 ) ],
mu.star[ 2:n.monitor ] ) )
par( mfrow = c( 2, 2 ) )
plot( 1:n.monitor, sigma.star, type = 'l', xlab = 'Iteration Number',
ylab = 'sigma', col = 'maroon' )
plot( density( sigma.star ), xlab = 'sigma',
lwd = 3, col = 'cornflowerblue', main = 'NB10 Case Study' )
sigma.hat.mle <- 3.700285
abline( v = sigma.hat.mle, lwd = 3, lty = 2, col = 'red' )
# legend( 402.2, 0.8, legend = 'MLE', col = 'red', lty = 2, lwd = 3 )
acf( as.ts( sigma.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'darkcyan', lwd = 3 )
pacf( as.ts( sigma.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'chocolate1', lwd = 3 )
par( mfrow = c( 1, 1 ) )
c( mean( sigma.star ), sd( sigma.star ), quantile( sigma.star,
probs = c( 0.0005, 0.9995 ) ) )
#                         0.05%    99.95%
# 3.9200491 0.4463147 2.6874819 5.6718138
print( rho.1.hat.sigma.star <- cor( sigma.star[ 1:( n.monitor - 1 ) ],
sigma.star[ 2:n.monitor ] ) )
# 0.4480396
print( se.sigma.star.mean <- ( sd( sigma.star ) / sqrt( n.monitor ) ) *
sqrt( ( 1 + rho.1.hat.sigma.star ) / ( 1 - rho.1.hat.sigma.star ) ) )
par( mfrow = c( 2, 2 ) )
plot( 1:n.monitor, nu.star, type = 'l', xlab = 'Iteration Number',
ylab = 'nu', col = 'maroon', ylim = c( 0, max( nu.star ) ) )
# the barrier at 2.0 for the nu.star values was imposed
# by the prior, which was set to Uniform( 2, 12 )
# because (as noted above) the t model has infinite variance for nu <= 2
plot( density( nu.star ), xlab = 'nu',
lwd = 3, col = 'cornflowerblue', main = 'NB10 Case Study' )
nu.hat.mle <- 3.008206
abline( v = nu.hat.mle, lwd = 3, lty = 2, col = 'red' )
legend( 6.0, 0.35, legend = 'MLE', col = 'red', lty = 2, lwd = 3 )
acf( as.ts( nu.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'darkcyan', lwd = 3 )
pacf( as.ts( nu.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'chocolate1', lwd = 3 )
par( mfrow = c( 1, 1 ) )
c( mean( nu.star ), sd( nu.star ), quantile( nu.star,
probs = c( 0.0005, 0.9995 ) ) )
#                        0.05%    99.95%
# 3.718455  1.219122  2.004299 11.254030
print( rho.1.hat.nu.star <- cor( nu.star[ 1:( n.monitor - 1 ) ],
nu.star[ 2:n.monitor ] ) )
# 0.5729619
print( se.nu.star.mean <- ( sd( nu.star ) / sqrt( n.monitor ) ) *
sqrt( ( 1 + rho.1.hat.nu.star ) / ( 1 - rho.1.hat.nu.star ) ) )
par( mfrow = c( 2, 2 ) )
plot( 1:n.monitor, y.new.star, type = 'l', xlab = 'Iteration Number',
ylab = 'y.new', col = 'maroon' )
plot( density( y.new.star ), xlab = 'y.new',
lwd = 3, col = 'cornflowerblue', main = 'NB10 Case Study' )
acf( as.ts( y.new.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'darkcyan', lwd = 3 )
pacf( as.ts( y.new.star[ 1:n.monitor ], start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'chocolate1', lwd = 3 )
par( mfrow = c( 1, 1 ) )
summary( nb10.data$y )
#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#  375.0   401.0   404.0   404.6   407.0   437.0
# let's replot the time series and density traces
# with the 'MCMC outliers' removed; i'll plot these traces
# for MCMC sampled values between the smallest and largest data values
y.new.star.trimmed <-
y.new.star[ ( y.new.star > 375 ) & ( y.new.star < 437 ) ]
1 - sum( ( y.new.star > 375 ) & ( y.new.star < 437 ) ) / n.monitor
# [1] 0.00352
( 1 - sum( ( y.new.star > 375 ) & ( y.new.star < 437 ) ) / n.monitor ) *
n.monitor
par( mfrow = c( 2, 2 ) )
plot( as.ts( y.new.star.trimmed ),
type = 'l', xlab = 'Iteration Number', ylab = 'y.new', col = 'maroon' )
plot( density( y.new.star.trimmed ),
xlab = 'y.new', lwd = 3, col = 'cornflowerblue', main = 'NB10 Case Study' )
acf( as.ts( y.new.star.trimmed, start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'darkcyan', lwd = 3 )
pacf( as.ts( y.new.star.trimmed, start = 1,
end = n.monitor, frequency = 1 ), lag.max = 10, main = '',
col = 'chocolate1', lwd = 3 )
par( mfrow = c( 1, 1 ) )
quantile( nb10.data$y,
probs = c( 0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99 ) )
#     1%     5%    10%    25%    50%    75%    90%    95%    99%
# 391.83 398.00 399.00 401.00 404.00 407.00 410.00 412.05 423.14
quantile( y.new.star.trimmed,
probs = c( 0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99 ) )
qqplot( nb10.data$y, y.new.star.trimmed, xlab = 'NB10 data',
ylab = 'Predictive distribution from t model',
col = 'maroon', type = 'l', lwd = 3 )
abline( 0, 1, lwd = 2, col = 'darkcyan', lty = 3 )
# the fit of this plot is really good
# because of the MCMC outliers, i'll make the next function call
# to produce a 99% predictive interval, rather than the usual 99.9%
c( mean( y.new.star.trimmed ), sd( y.new.star.trimmed ),
quantile( y.new.star.trimmed, probs = c( 0.005, 0.995 ) ) )
#                             0.5%      99.5%
# 404.292382   7.207702 383.031180 425.611887
print( rho.1.hat.y.new.star <- cor( y.new.star[ 1:( n.monitor - 1 ) ],
y.new.star[ 2:n.monitor ] ) )
# 0.006518032
print( se.y.new.star.mean <- ( sd( y.new.star ) / sqrt( n.monitor ) ) *
sqrt( ( 1 + rho.1.hat.y.new.star ) / ( 1 - rho.1.hat.y.new.star ) ) )
# 0.02057306
# even though rho.1.hat.y.new.star is essentially 0, the MCSE for
# the mean of the posterior predictive distribution is about 3 times
# larger than that for nu (the worst-mixing parameter); this is
# because the SD of the posterior predictive distribution (6.46)
# is so much larger than the posterior SDs of the parameters (we
# noticed this in the Poisson length-of-stay case study: prediction
# of future data values is much noisier than parameter estimation)
# we would conclude that, according to the t model, future weighings
# of NB10 should produce values around 404.3 micrograms below
# 10 grams (MCSE 0.02), give or take about 6.5 micrograms, and that about 99%
# of those future data values should be between about 383.0 and
# 425.6 micrograms below 10 grams
c( mean( nb10.data$y ), sd( nb10.data$y ) )
# 404.590000   6.466846
c( mean( y.new.star.trimmed ), sd( y.new.star.trimmed ) )
# [1] 404.321287   5.592268
sum( ( 383.0 < nb10.data$y ) * ( nb10.data$y < 425.6 ) ) / 100
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
